<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="personnel">
	<select id="findByEmpNameContaining"
		resultType="com.ict.project.vo.personnel.EmployeeVO">
		SELECT e.emp_idx, u.emp_name, e.pay_grade, e.position, e.dept_name,
		e.hire_date,
		e.employment_type, s.base_salary AS salary, s.bonus
		FROM employee e
		INNER JOIN users u ON e.user_idx = u.user_idx
		LEFT JOIN request r ON e.emp_idx = r.emp_idx
		LEFT JOIN salary s ON r.request_idx = s.request_idx
		WHERE u.emp_name LIKE CONCAT('%', #{keyword}, '%')
	</select>

	<select id="findByDeptNameContaining"
		resultType="com.ict.project.vo.personnel.EmployeeVO">
		SELECT e.emp_idx, u.emp_name, e.pay_grade, e.position, e.dept_name,
		e.hire_date,
		e.employment_type, s.base_salary AS salary, s.bonus
		FROM employee e
		INNER JOIN users u ON e.user_idx = u.user_idx
		LEFT JOIN salary s ON e.emp_idx = (SELECT r.emp_idx FROM request r WHERE
		r.request_idx = s.request_idx)
		WHERE e.dept_name LIKE CONCAT('%', #{keyword}, '%')
	</select>

	<select id="findByPositionContaining"
		resultType="com.ict.project.vo.personnel.EmployeeVO">
		SELECT e.emp_idx, u.emp_name, e.pay_grade, e.position, e.dept_name,
		e.hire_date,
		e.employment_type, s.base_salary AS salary, s.bonus
		FROM employee e
		INNER JOIN users u ON e.user_idx = u.user_idx
		LEFT JOIN salary s ON e.emp_idx = (SELECT r.emp_idx FROM request r WHERE
		r.request_idx = s.request_idx)
		WHERE e.position LIKE CONCAT('%', #{keyword}, '%')
	</select>

</mapper>















